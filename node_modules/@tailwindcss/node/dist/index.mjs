var ue=Object.defineProperty;var me=(e,t)=>{for(var i in t)ue(e,i,{get:t[i],enumerable:!0})};import*as D from"node:module";import{pathToFileURL as Xe}from"node:url";var F={};me(F,{DEBUG:()=>de});var de=pe(process.env.DEBUG);function pe(e){if(e===void 0)return!1;if(e==="true"||e==="1")return!0;if(e==="false"||e==="0")return!1;if(e==="*")return!0;let t=e.split(",").map(i=>i.split(":")[0]);return t.includes("-tailwindcss")?!1:!!t.includes("tailwindcss")}import $ from"enhanced-resolve";import{createJiti as ze}from"jiti";import oe from"node:fs";import le from"node:fs/promises";import L,{dirname as te}from"node:path";import{pathToFileURL as re}from"node:url";import{__unstable__loadDesignSystem as Ge,compile as Je}from"tailwindcss";import P from"node:fs/promises";import y from"node:path";var ge=[/import[\s\S]*?['"](.{3,}?)['"]/gi,/import[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/export[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/require\(['"`](.+)['"`]\)/gi],he=[".js",".cjs",".mjs"],xe=["",".js",".cjs",".mjs",".ts",".cts",".mts",".jsx",".tsx"],ye=["",".ts",".cts",".mts",".tsx",".js",".cjs",".mjs",".jsx"];async function Ae(e,t){for(let i of t){let o=`${e}${i}`;if((await P.stat(o).catch(()=>null))?.isFile())return o}for(let i of t){let o=`${e}/index${i}`;if(await P.access(o).then(()=>!0,()=>!1))return o}return null}async function M(e,t,i,o){let r=he.includes(o)?xe:ye,s=await Ae(y.resolve(i,t),r);if(s===null||e.has(s))return;e.add(s),i=y.dirname(s),o=y.extname(s);let n=await P.readFile(s,"utf-8"),c=[];for(let a of ge)for(let l of n.matchAll(a))l[1].startsWith(".")&&c.push(M(e,l[1],i,o));await Promise.all(c)}async function B(e){let t=new Set;return await M(t,e,y.dirname(e),y.extname(e)),Array.from(t)}import*as T from"node:path";var A=92,S=47,E=42,Re=34,Ce=39,we=58,v=59,h=10,R=32,k=9,W=123,U=125,O=40,z=41,Se=91,Ee=93,G=45,b=64,ve=33;function K(e){e=e.replaceAll(`\r
`,`
`);let t=[],i=[],o=[],r=null,s=null,n="",c="",a;for(let l=0;l<e.length;l++){let u=e.charCodeAt(l);if(u===A)n+=e.slice(l,l+2),l+=1;else if(u===S&&e.charCodeAt(l+1)===E){let f=l;for(let d=l+2;d<e.length;d++)if(a=e.charCodeAt(d),a===A)d+=1;else if(a===E&&e.charCodeAt(d+1)===S){l=d+1;break}let m=e.slice(f,l+1);m.charCodeAt(2)===ve&&i.push(q(m.slice(2,-2)))}else if(u===Ce||u===Re){let f=l;for(let m=l+1;m<e.length;m++)if(a=e.charCodeAt(m),a===A)m+=1;else if(a===u){l=m;break}else{if(a===v&&e.charCodeAt(m+1)===h)throw new Error(`Unterminated string: ${e.slice(f,m+1)+String.fromCharCode(u)}`);if(a===h)throw new Error(`Unterminated string: ${e.slice(f,m)+String.fromCharCode(u)}`)}n+=e.slice(f,l+1)}else{if((u===R||u===h||u===k)&&(a=e.charCodeAt(l+1))&&(a===R||a===h||a===k))continue;if(u===h){if(n.length===0)continue;a=n.charCodeAt(n.length-1),a!==R&&a!==h&&a!==k&&(n+=" ")}else if(u===G&&e.charCodeAt(l+1)===G&&n.length===0){let f="",m=l,d=-1;for(let p=l+2;p<e.length;p++)if(a=e.charCodeAt(p),a===A)p+=1;else if(a===S&&e.charCodeAt(p+1)===E){for(let g=p+2;g<e.length;g++)if(a=e.charCodeAt(g),a===A)g+=1;else if(a===E&&e.charCodeAt(g+1)===S){p=g+1;break}}else if(d===-1&&a===we)d=n.length+p-m;else if(a===v&&f.length===0){n+=e.slice(m,p),l=p;break}else if(a===O)f+=")";else if(a===Se)f+="]";else if(a===W)f+="}";else if((a===U||e.length-1===p)&&f.length===0){l=p-1,n+=e.slice(m,p);break}else(a===z||a===Ee||a===U)&&f.length>0&&e[p]===f[f.length-1]&&(f=f.slice(0,-1));let x=J(n,d);r?r.nodes.push(x):t.push(x),n=""}else if(u===v&&n.charCodeAt(0)===b)s=C(n),r?r.nodes.push(s):t.push(s),n="",s=null;else if(u===v&&c[c.length-1]!==")"){let f=J(n);r?r.nodes.push(f):t.push(f),n=""}else if(u===W&&c[c.length-1]!==")")c+="}",s=N(n.trim()),r&&r.nodes.push(s),o.push(r),r=s,n="",s=null;else if(u===U&&c[c.length-1]!==")"){if(c==="")throw new Error("Missing opening {");if(c=c.slice(0,-1),n.length>0)if(n.charCodeAt(0)===b)s=C(n),r?r.nodes.push(s):t.push(s),n="",s=null;else{let m=n.indexOf(":");if(r){let d=n.indexOf("!important",m+1);r.nodes.push({kind:"declaration",property:n.slice(0,m).trim(),value:n.slice(m+1,d===-1?n.length:d).trim(),important:d!==-1})}}let f=o.pop()??null;f===null&&r&&t.push(r),r=f,n="",s=null}else if(u===O)c+=")",n+="(";else if(u===z){if(c[c.length-1]!==")")throw new Error("Missing opening (");c=c.slice(0,-1),n+=")"}else{if(n.length===0&&(u===R||u===h||u===k))continue;n+=String.fromCharCode(u)}}}if(n.charCodeAt(0)===b&&t.push(C(n)),c.length>0&&r){if(r.kind==="rule")throw new Error(`Missing closing } at ${r.selector}`);if(r.kind==="at-rule")throw new Error(`Missing closing } at ${r.name} ${r.params}`)}return i.length>0?i.concat(t):t}function C(e,t=[]){for(let i=5;i<e.length;i++){let o=e.charCodeAt(i);if(o===R||o===O){let r=e.slice(0,i).trim(),s=e.slice(i).trim();return w(r,s,t)}}return w(e.trim(),"",t)}function J(e,t=e.indexOf(":")){let i=e.indexOf("!important",t+1);return{kind:"declaration",property:e.slice(0,t).trim(),value:e.slice(t+1,i===-1?e.length:i).trim(),important:i!==-1}}var ke=64;function Ne(e,t=[]){return{kind:"rule",selector:e,nodes:t}}function w(e,t="",i=[]){return{kind:"at-rule",name:e,params:t,nodes:i}}function N(e,t=[]){return e.charCodeAt(0)===ke?C(e,t):Ne(e,t)}function H(e,t){return{kind:"declaration",property:e,value:t,important:!1}}function q(e){return{kind:"comment",value:e}}function _(e,t,i=[],o={}){for(let r=0;r<e.length;r++){let s=e[r],n=[...i,s],c=i.at(-1)??null;if(s.kind==="context"){_(s.nodes,t,i,{...o,...s.context});continue}let a=t(s,{parent:c,context:o,path:n,replaceWith(l){e.splice(r,1,...Array.isArray(l)?l:[l]),r--}})??0;if(a===2)return;a!==1&&(s.kind==="rule"||s.kind==="at-rule")&&_(s.nodes,t,n,o)}}function Q(e){let t="",i=new Set,o=[],r=[];function s(l,u=0){let f="",m="  ".repeat(u);if(l.kind==="rule"){f+=`${m}${l.selector} {
`;for(let d of l.nodes)f+=s(d,u+1);f+=`${m}}
`}else if(l.kind==="at-rule"){if(l.nodes.length===0)return`${m}${l.name} ${l.params};
`;if(l.name==="@property"&&u===0){if(i.has(l.params))return"";let d=l.params,x=null,p=!1;for(let g of l.nodes)g.kind==="declaration"&&(g.property==="initial-value"?x=g.value:g.property==="inherits"&&(p=g.value==="true"));p?o.push(H(d,x??"initial")):r.push(H(d,x??"initial")),i.add(l.params)}f+=`${m}${l.name}${l.params?` ${l.params} `:" "}{
`;for(let d of l.nodes)f+=s(d,u+1);f+=`${m}}
`}else if(l.kind==="comment")f+=`${m}/*${l.value}*/
`;else if(l.kind==="context")for(let d of l.nodes)f+=s(d,u);else if(l.kind==="at-root"){for(let d of l.nodes)t+=s(d,0);return f}else l.property!=="--tw-sort"&&l.value!==void 0&&l.value!==null&&(f+=`${m}${l.property}: ${l.value}${l.important?" !important":""};
`);return f}let n="";for(let l of e){let u=s(l);u!==""&&(n+=u)}let c=[];o.length&&c.push(N(":root",o)),r.length&&c.push(N("*, ::before, ::after, ::backdrop",r));let a="";return c.length&&(a=s(w("@supports","(-moz-orient: inline)",[w("@layer","base",c)]))),`${n}${a}${t}`}function _e(e,t){if(typeof e!="string")throw new TypeError("expected path to be a string");if(e==="\\"||e==="/")return"/";var i=e.length;if(i<=1)return e;var o="";if(i>4&&e[3]==="\\"){var r=e[2];(r==="?"||r===".")&&e.slice(0,2)==="\\\\"&&(e=e.slice(2),o="//")}var s=e.split(/[/\\]+/);return t!==!1&&s[s.length-1]===""&&s.pop(),o+s.join("/")}function I(e){let t=_e(e);return e.startsWith("\\\\")&&t.startsWith("/")&&!t.startsWith("//")?`/${t}`:t}var j=/(?<!@import\s+)(?<=^|[^\w\-\u0080-\uffff])url\((\s*('[^']+'|"[^"]+")\s*|[^'")]+)\)/,Y=/(?<=image-set\()((?:[\w-]{1,256}\([^)]*\)|[^)])*)(?=\))/,$e=/(?:gradient|element|cross-fade|image)\(/,De=/^\s*data:/i,Pe=/^([a-z]+:)?\/\//,Ue=/^[A-Z_][.\w-]*\(/i,be=/(?:^|\s)(?<url>[\w-]+\([^)]*\)|"[^"]*"|'[^']*'|[^,]\S*[^,])\s*(?:\s(?<descriptor>\w[^,]+))?(?:,|$)/g,Oe=/(?<!\\)"/g,Ie=/(?: |\\t|\\n|\\f|\\r)+/g,Te=e=>De.test(e),je=e=>Pe.test(e);async function X({css:e,base:t,root:i}){if(!e.includes("url(")&&!e.includes("image-set("))return e;let o=K(e),r=[];function s(n){let c=T.posix.join(I(t),n),a=T.posix.relative(I(i),c);return a.startsWith(".")||(a="./"+a),a}return _(o,n=>{if(n.kind!=="declaration"||!n.value)return;let c=j.test(n.value),a=Y.test(n.value);if(c||a){let l=a?Le:V;r.push(l(n.value,s).then(u=>{n.value=u}))}}),r.length&&await Promise.all(r),Q(o)}function V(e,t){return ee(e,j,async i=>{let[o,r]=i;return await Z(r.trim(),o,t)})}async function Le(e,t){return await ee(e,Y,async i=>{let[,o]=i;return await Me(o,async({url:s})=>j.test(s)?await V(s,t):$e.test(s)?s:await Z(s,s,t))})}async function Z(e,t,i,o="url"){let r="",s=e[0];if((s==='"'||s==="'")&&(r=s,e=e.slice(1,-1)),Fe(e))return t;let n=await i(e);return r===""&&n!==encodeURI(n)&&(r='"'),r==="'"&&n.includes("'")&&(r='"'),r==='"'&&n.includes('"')&&(n=n.replace(Oe,'\\"')),`${o}(${r}${n}${r})`}function Fe(e){return je(e)||Te(e)||e[0]==="#"||Ue.test(e)}function Me(e,t){return Promise.all(Be(e).map(async({url:i,descriptor:o})=>({url:await t({url:i,descriptor:o}),descriptor:o}))).then(We)}function Be(e){let t=e.trim().replace(Ie," ").replace(/\r?\n/,"").replace(/,\s+/,", ").replaceAll(/\s+/g," ").matchAll(be);return Array.from(t,({groups:i})=>({url:i?.url?.trim()??"",descriptor:i?.descriptor?.trim()??""})).filter(({url:i})=>!!i)}function We(e){return e.map(({url:t,descriptor:i})=>t+(i?` ${i}`:"")).join(", ")}async function ee(e,t,i){let o,r=e,s="";for(;o=t.exec(r);)s+=r.slice(0,o.index),s+=await i(o),r=r.slice(o.index+o[0].length);return s+=r,s}async function Ke(e,{base:t,onDependency:i,shouldRewriteUrls:o}){let r=await Je(e,{base:t,async loadModule(s,n){return ae(s,n,i)},async loadStylesheet(s,n){let c=await ce(s,n,i);return o&&(c.content=await X({css:c.content,root:n,base:c.base})),c}});if(r.root&&r.root!=="none"){let s=/[*{]/,n=[];for(let a of r.root.pattern.split("/")){if(s.test(a))break;n.push(a)}if(!await le.stat(L.resolve(t,n.join("/"))).then(a=>a.isDirectory()).catch(()=>!1))throw new Error(`The \`source(${r.root.pattern})\` does not exist`)}return r}async function qe(e,{base:t}){return Ge(e,{base:t,async loadModule(i,o){return ae(i,o,()=>{})},async loadStylesheet(i,o){return ce(i,o,()=>{})}})}async function ae(e,t,i){if(e[0]!=="."){let n=await ie(e,t);if(!n)throw new Error(`Could not resolve '${e}' from '${t}'`);let c=await se(re(n).href);return{base:te(n),module:c.default??c}}let o=await ie(e,t);if(!o)throw new Error(`Could not resolve '${e}' from '${t}'`);let[r,s]=await Promise.all([se(re(o).href+"?id="+Date.now()),B(o)]);for(let n of s)i(n);return{base:te(o),module:r.default??r}}async function ce(e,t,i){let o=await Qe(e,t);if(!o)throw new Error(`Could not resolve '${e}' from '${t}'`);if(i(o),typeof globalThis.__tw_readFile=="function"){let s=await globalThis.__tw_readFile(o,"utf-8");if(s)return{base:L.dirname(o),content:s}}let r=await le.readFile(o,"utf-8");return{base:L.dirname(o),content:r}}var ne=null;async function se(e){try{return await import(e)}catch{return ne??=ze(import.meta.url,{moduleCache:!1,fsCache:!1}),await ne.import(e)}}var He=$.ResolverFactory.createResolver({fileSystem:new $.CachedInputFileSystem(oe,4e3),useSyncFileSystemCalls:!0,extensions:[".css"],mainFields:["style"],conditionNames:["style"]});async function Qe(e,t){if(typeof globalThis.__tw_resolve=="function"){let i=globalThis.__tw_resolve(e,t);if(i)return Promise.resolve(i)}return fe(He,e,t)}var Ye=$.ResolverFactory.createResolver({fileSystem:new $.CachedInputFileSystem(oe,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:import.meta.url?["node","import"]:["node","require"]});function ie(e,t){return fe(Ye,e,t)}function fe(e,t,i){return new Promise((o,r)=>e.resolve({},i,t,{},(s,n)=>{if(s)return r(s);o(n)}))}if(!process.versions.bun){let e=D.createRequire(import.meta.url);D.register?.(Xe(e.resolve("@tailwindcss/node/esm-cache-loader")))}export{qe as __unstable__loadDesignSystem,Ke as compile,F as env,I as normalizePath};
